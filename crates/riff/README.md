# RIFF: Resource Interchange File Format

複数のデータを一つのファイルに纏めたファイル形式。AVIファイルで映像と音声のストリームをまとめるのに使われている。

- 仕様書: 検索したがみあたらず。Microsoftのドキュメントが参考になる。

  https://learn.microsoft.com/en-us/windows/win32/xaudio2/resource-interchange-file-format--riff-

# ファイル構造

## チャンク

データの単位。 チャンクは以下の構造を持つ。

| オフセット[byte] | サイズ[byte] | 内容      |
|-------------|-----------|---------|
| 0           | 4         | チャンク識別子 |
| 4           | 4         | データ長    |
| 8           | データ長      | データ本体   |

データ長はデータ本体のみのバイトサイズであり、その他の領域を含めたチャンク全体のサイズはデータ長+8byteである。

## サブチャンク

チャンク識別子が `RIFF` または `LIST` の場合、子チャンクを持つことができる。

このような親チャンクのデータ部には、先頭4byteにフォーマット識別子が置かれ、その後に子チャンクが続く。

## RIFFチャンク

チャンク識別子が "RIFF" のチャンク、RIFFファイルのルートとなるチャンクであり、RIFFファイルは全体が1つのRIFFチャンクである。

# 読み込みの流れ

要はチャンクが深さ優先に並んでいるので、スタックに積みながら先頭から順にパースすれば良い。